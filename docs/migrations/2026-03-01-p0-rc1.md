# Migration: P0 RC1 Session/State Layout

Date: 2026-03-01
Version: `v0.1.0-rc.1`

## Summary

P0 introduced new on-disk session/state formats and operational files.

If your workspace contains older `.drost` state from pre-P0 builds, clear it before running the RC:

```bash
rm -rf .drost
```

Then restart:

```bash
pnpm build
node packages/cli/dist/bin.js start --ui plain
```

## New/Updated Runtime Files

- `.drost/sessions/<session-id>.jsonl` - user/assistant transcript messages.
- `.drost/sessions/<session-id>.full.jsonl` - complete event stream (tool calls, tool results, runtime events).
- `.drost/sessions/.drost-sessions-index.jsonl` - session index metadata.
- `.drost/orchestration-lanes.json` - lane snapshot state when `orchestration.persistState=true`.
- `.drost/observability/*.jsonl` - runtime/tool/usage observability streams when enabled.

## Compatibility

Backward compatibility with pre-P0 `.drost` state is intentionally not required for this RC.

## Validation Checklist

- `/sessions` returns recent sessions.
- `/new` creates a new timestamped session and keeps previous transcripts.
- `/session <id>` switches and appends to the selected session files.
- Control API `/control/v1/status` returns `controlUrl` and runtime status.
